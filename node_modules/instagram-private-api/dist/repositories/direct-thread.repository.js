"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const repository_1 = require("../core/repository");
const Chance = require("chance");
class DirectThreadRepository extends repository_1.Repository {
    async broadcast(options) {
        const mutationToken = new Chance().guid();
        const recipients = options.threadIds || options.userIds;
        const recipientsType = options.threadIds ? 'thread_ids' : 'recipient_users';
        const recipientsIds = recipients instanceof Array ? recipients : [recipients];
        const { body } = await this.client.request.send({
            url: `/api/v1/direct_v2/threads/broadcast/${options.item}/`,
            method: 'POST',
            form: Object.assign({ action: 'send_item', [recipientsType]: JSON.stringify(recipientsType === 'thread_ids' ? recipientsIds : [recipientsIds]), client_context: mutationToken, _csrftoken: this.client.state.cookieCsrfToken, device_id: this.client.state.deviceId, mutation_token: mutationToken, _uuid: this.client.state.uuid }, options.form),
        });
        return body;
    }
}
exports.DirectThreadRepository = DirectThreadRepository;
//# sourceMappingURL=direct-thread.repository.js.map